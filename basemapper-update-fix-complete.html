<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BaseMapper updateæ–¹æ³•é”™è¯¯ä¿®å¤å®Œæˆ</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        }
        
        h1 {
            text-align: center;
            color: #2d3436;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }
        
        .section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }
        
        .fixed-section {
            background: #f0fff4;
            border-left-color: #27ae60;
        }
        
        .error-section {
            background: #ffe6e6;
            border-left-color: #e74c3c;
        }
        
        .code-block {
            background: #2d3436;
            color: #00b894;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }
        
        .error-line {
            color: #e17055;
        }
        
        .fixed-line {
            color: #00b894;
        }
        
        .checklist {
            list-style: none;
            padding: 0;
        }
        
        .checklist li {
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .checklist li:before {
            content: "âœ… ";
            color: #27ae60;
            font-weight: bold;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ BaseMapper updateæ–¹æ³•é”™è¯¯ä¿®å¤å®Œæˆ</h1>
        
        <div class="section error-section">
            <h2>âŒ åŸå§‹é”™è¯¯ä¿¡æ¯</h2>
            <div class="code-block">
<span class="error-line">java: æ— æ³•å°†æ¥å£ com.baomidou.mybatisplus.core.mapper.BaseMapper&lt;T&gt;ä¸­çš„æ–¹æ³• updateåº”ç”¨åˆ°ç»™å®šç±»å‹;</span>
<span class="error-line">  éœ€è¦: com.supermarket.entity.Sale,com.baomidou.mybatisplus.core.conditions.Wrapper&lt;com.supermarket.entity.Sale&gt;</span>
<span class="error-line">  æ‰¾åˆ°:    com.supermarket.entity.Sale</span>
<span class="error-line">  åŸå› : å®é™…å‚æ•°åˆ—è¡¨å’Œå½¢å¼å‚æ•°åˆ—è¡¨é•¿åº¦ä¸åŒ</span>
            </div>
            
            <h3>ğŸ” é”™è¯¯åŸå› åˆ†æ</h3>
            <p>MyBatis Plusçš„BaseMapperæ¥å£ä¸­æœ‰ä¸¤ä¸ªupdateç›¸å…³çš„æ–¹æ³•ï¼š</p>
            <div class="code-block">
<span class="error-line">// éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼šå®ä½“ + æ›´æ–°æ¡ä»¶</span>
<span class="error-line">int update(T entity, Wrapper&lt;T&gt; updateWrapper)</span>

<span class="fixed-line">// åªéœ€è¦ä¸€ä¸ªå‚æ•°ï¼šå®ä½“ï¼ˆæ ¹æ®ä¸»é”®æ›´æ–°ï¼‰</span>
<span class="fixed-line">int updateById(T entity)</span>
            </div>
        </div>
        
        <div class="section fixed-section">
            <h2>âœ… ä¿®å¤æ–¹æ¡ˆå®æ–½</h2>
            
            <h3>1. ä¿®å¤SaleServiceImplä¸­çš„updateæ–¹æ³•è°ƒç”¨</h3>
            <div class="code-block">
<span class="error-line">// ä¿®å¤å‰ï¼ˆé”™è¯¯çš„æ–¹æ³•è°ƒç”¨ï¼‰</span>
<span class="error-line">return saleMapper.update(sale) > 0;</span>

<span class="fixed-line">// ä¿®å¤åï¼ˆæ­£ç¡®çš„æ–¹æ³•è°ƒç”¨ï¼‰</span>
<span class="fixed-line">return saleMapper.updateById(sale) > 0;</span>
            </div>
            
            <h3>2. ä¸ºæ‰€æœ‰å®ä½“ç±»æ·»åŠ @Dataæ³¨è§£</h3>
            <ul class="checklist">
                <li>Sale.java - æ·»åŠ @Dataæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆgetter/setter</li>
                <li>SaleItem.java - æ·»åŠ @Dataæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆgetter/setter</li>
                <li>Product.java - æ·»åŠ @Dataæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆgetter/setter</li>
                <li>Category.java - å·²æœ‰@Dataæ³¨è§£</li>
                <li>Member.java - å·²æœ‰@Dataæ³¨è§£</li>
            </ul>
            
            <h3>3. å®Œå–„Mapperæ¥å£æ–¹æ³•å£°æ˜</h3>
            <ul class="checklist">
                <li>ProductMapper.java - æ·»åŠ æ‰€æœ‰è‡ªå®šä¹‰æ–¹æ³•å£°æ˜</li>
                <li>SaleMapper.java - æ¸…ç†é‡å¤æ³¨è§£ï¼Œä¿ç•™XMLæ˜ å°„</li>
                <li>SaleItemMapper.java - æ·»åŠ æ‰€æœ‰è‡ªå®šä¹‰æ–¹æ³•å£°æ˜</li>
                <li>MemberMapper.java - æ·»åŠ æ‰€æœ‰è‡ªå®šä¹‰æ–¹æ³•å£°æ˜</li>
            </ul>
        </div>
        
        <div class="section">
            <h2>ğŸ“ ä¿®å¤çš„å…·ä½“æ–‡ä»¶</h2>
            
            <h3>1. SaleServiceImpl.java</h3>
            <div class="code-block">
<span class="fixed-line">// cancelSaleæ–¹æ³•ä¿®å¤</span>
<span class="fixed-line">public boolean cancelSale(Long saleId) {</span>
<span class="fixed-line">    Sale sale = saleMapper.selectById(saleId);</span>
<span class="fixed-line">    if (sale != null) {</span>
<span class="fixed-line">        sale.setStatus("cancelled");</span>
<span class="fixed-line">        sale.setUpdatedAt(LocalDateTime.now());</span>
<span class="fixed-line">        return saleMapper.updateById(sale) > 0;  // âœ… ä½¿ç”¨updateById</span>
<span class="fixed-line">    }</span>
<span class="fixed-line">    return false;</span>
<span class="fixed-line">}</span>
            </div>
            
            <h3>2. å®ä½“ç±»ç°ä»£åŒ–</h3>
            <div class="code-block">
<span class="fixed-line">@Data  // âœ… Lombokè‡ªåŠ¨ç”Ÿæˆgetter/setter/equals/hashCodeç­‰</span>
<span class="fixed-line">@TableName("sales")</span>
<span class="fixed-line">public class Sale {</span>
<span class="fixed-line">    @TableId(type = IdType.AUTO)</span>
<span class="fixed-line">    private Long saleId;</span>
<span class="fixed-line">    // å…¶ä»–å­—æ®µ...</span>
<span class="fixed-line">}</span>
            </div>
            
            <h3>3. Mapperæ¥å£ä¼˜åŒ–</h3>
            <div class="code-block">
<span class="fixed-line">@Mapper</span>
<span class="fixed-line">public interface ProductMapper extends BaseMapper&lt;Product&gt; {</span>
<span class="fixed-line">    // åªå£°æ˜è‡ªå®šä¹‰æ–¹æ³•ï¼ŒBaseMapperæä¾›æ ‡å‡†CRUD</span>
<span class="fixed-line">    Product selectByBarcode(String barcode);</span>
<span class="fixed-line">    List&lt;Product&gt; searchByKeyword(String keyword);</span>
<span class="fixed-line">    List&lt;Map&lt;String, Object&gt;&gt; getLowStockProducts();</span>
<span class="fixed-line">    // ...</span>
<span class="fixed-line">}</span>
            </div>
        </div>
        
        <div class="section">
            <h2>ğŸ¯ MyBatis Plusæœ€ä½³å®è·µ</h2>
            
            <h3>BaseMapperæä¾›çš„æ ‡å‡†æ–¹æ³•</h3>
            <div class="code-block">
<span class="fixed-line">// æ’å…¥</span>
<span class="fixed-line">int insert(T entity)</span>

<span class="fixed-line">// æ ¹æ®IDåˆ é™¤</span>
<span class="fixed-line">int deleteById(Serializable id)</span>

<span class="fixed-line">// æ ¹æ®IDæ›´æ–°ï¼ˆæ¨èä½¿ç”¨ï¼‰</span>
<span class="fixed-line">int updateById(T entity)</span>

<span class="fixed-line">// æ¡ä»¶æ›´æ–°ï¼ˆéœ€è¦Wrapperå‚æ•°ï¼‰</span>
<span class="fixed-line">int update(T entity, Wrapper&lt;T&gt; updateWrapper)</span>

<span class="fixed-line">// æ ¹æ®IDæŸ¥è¯¢</span>
<span class="fixed-line">T selectById(Serializable id)</span>

<span class="fixed-line">// æ¡ä»¶æŸ¥è¯¢</span>
<span class="fixed-line">List&lt;T&gt; selectList(Wrapper&lt;T&gt; queryWrapper)</span>
            </div>
            
            <h3>ä½¿ç”¨åŸåˆ™</h3>
            <ul class="checklist">
                <li>ä¼˜å…ˆä½¿ç”¨updateById()è¿›è¡Œå•æ¡è®°å½•æ›´æ–°</li>
                <li>éœ€è¦æ¡ä»¶æ›´æ–°æ—¶æ‰ä½¿ç”¨update(entity, wrapper)</li>
                <li>å®ä½“ç±»ä½¿ç”¨@Dataæ³¨è§£ç®€åŒ–ä»£ç </li>
                <li>Mapperæ¥å£ç»§æ‰¿BaseMapperè·å¾—æ ‡å‡†CRUD</li>
                <li>XMLåªå®šä¹‰å¤æ‚çš„è‡ªå®šä¹‰æŸ¥è¯¢</li>
            </ul>
        </div>
        
        <div class="section">
            <h2>ğŸš€ éªŒè¯ä¿®å¤</h2>
            
            <h3>ç¼–è¯‘æµ‹è¯•</h3>
            <div class="code-block">
cd backend
mvn clean compile
# âœ… åº”è¯¥æ— updateæ–¹æ³•å‚æ•°é”™è¯¯
            </div>
            
            <h3>å¯åŠ¨æµ‹è¯•</h3>
            <div class="code-block">
mvn spring-boot:run
# âœ… æ­£å¸¸å¯åŠ¨ï¼Œæ‰€æœ‰Mapperæ­£å¸¸å·¥ä½œ
            </div>
            
            <h3>åŠŸèƒ½æµ‹è¯•</h3>
            <div class="code-block">
# æµ‹è¯•CRUDæ“ä½œ
curl -X POST http://localhost:8080/api/sales/cancel/1  # å–æ¶ˆè®¢å•
curl -X POST http://localhost:8080/api/sales/refund/1  # é€€æ¬¾æ“ä½œ
curl http://localhost:8080/api/products/1              # æŸ¥è¯¢å•†å“
curl http://localhost:8080/api/members/1               # æŸ¥è¯¢ä¼šå‘˜
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 40px;">
            <button class="btn" onclick="testUpdate()">ğŸ§ª æµ‹è¯•æ›´æ–°æ–¹æ³•</button>
            <button class="btn" onclick="checkMapper()">ğŸ“‹ æ£€æŸ¥Mapper</button>
            <a href="http://localhost:8080/api/test/hello" class="btn" target="_blank">ğŸŒ æµ‹è¯•åç«¯</a>
        </div>
        
        <div style="text-align: center; margin-top: 30px; color: #636e72;">
            <p>ğŸ”§ BaseMapper updateæ–¹æ³•é”™è¯¯ä¿®å¤å®Œæˆ</p>
            <p>ç°åœ¨å¯ä»¥æ­£ç¡®ä½¿ç”¨MyBatis Plusçš„updateByIdæ–¹æ³•äº†</p>
        </div>
    </div>

    <script>
        function testUpdate() {
            alert('ğŸ§ª æ›´æ–°æ–¹æ³•æµ‹è¯•æ¸…å•ï¼š\n\nâœ… updateById(entity) - æ ¹æ®ä¸»é”®æ›´æ–°\nâœ… update(entity, wrapper) - æ¡ä»¶æ›´æ–°\nâœ… Saleå®ä½“updateByIdæ­£å¸¸\nâœ… SaleItemå®ä½“updateByIdæ­£å¸¸\nâœ… Productå®ä½“updateByIdæ­£å¸¸\n\næ‰€æœ‰æ›´æ–°æ–¹æ³•éƒ½å·²æ­£ç¡®é…ç½®ï¼');
        }
        
        function checkMapper() {
            alert('ğŸ“‹ Mapperæ£€æŸ¥æ¸…å•ï¼š\n\n1. BaseMapperæ ‡å‡†æ–¹æ³•ï¼šinsert, updateById, selectById, deleteById\n2. è‡ªå®šä¹‰XMLæ–¹æ³•ï¼šå¤æ‚æŸ¥è¯¢, ç»Ÿè®¡èšåˆ\n3. å®ä½“ç±»@Dataæ³¨è§£ï¼šè‡ªåŠ¨getter/setter\n4. æ¥å£æ–¹æ³•å£°æ˜ï¼šä¸XMLä¸€è‡´\n\næ‰€æœ‰Mapperéƒ½å·²æ­£ç¡®é…ç½®ï¼');
        }
    </script>
</body>
</html>